@using Uch_PracticeV3.Models
@model Student
@{
    ViewBag.Title = ViewBag.Action;
}

    <form action="/Admin/Students/@ViewBag.Action" method="post">

        <div class="form-group">
            <label for="Id">Код</label>
            @if (ViewBag.Action == "edit")
            {
                <input readonly class="form-control" name="Id" value="@ViewBag.Student.Id" />
            }
            else
            {
                <input name="Id" class="form-control" />
            }
        </div>
        <div class="form-group">
            <label for="Surname">Фамилия</label>
            @if (ViewBag.Action == "edit")
            {
                <input name="Surname" type="text" class="form-control" id="Surname"
                       value="@ViewBag.Student.Surname">
            }
            else
            {
                <input name="Surname" type="text" class="form-control" id="Surname">
            }
        </div>
        <div class="form-group">
            <label for="Name">Имя</label>
            @if (ViewBag.Action == "edit")
            {
                <input name="Name" type="text" class="form-control" id="Name"
                       value="@ViewBag.Student.Name">
            }
            else
            {
                <input name="Name" type="text" class="form-control" id="Name">
            }
        </div>
        <div class="form-group">
            <label for="Patronymic">Отчество</label>
            @if (ViewBag.Action == "edit")
            {
                <input name="Patronymic" type="text" class="form-control" id="Patronymic"
                       value="@ViewBag.Student.Patronymic">
            }
            else
            {
                <input name="Patronymic" type="text" class="form-control" id="Patronymic">
            }
        </div>
        <div class="form-group">
            <label for="GroupId">Группа</label>
            <select class="form-control" name="GroupId" id="GroupId">
                @foreach (Group group in ViewBag.Groups)
                {
                    if (ViewBag.Action == "edit")
                    {
                        <option selected="@(group.Id == @ViewBag.Student.GroupId)" data-toggle="tooltip"
                                data-placement="right" title="@group.Naming">
                            @group.Id
                        </option>
                    }
                    else
                    {
                        <option data-toggle="tooltip" data-placement="right" title="@group.Naming">@group.Id</option>
                    }
                }
            </select>
        </div>
        <div class="form-group">
            <label for="LeaderId">Руководитель</label>
            <select class="form-control" name="LeaderId" id="LeaderId">
                @foreach (Leader leader in ViewBag.Leaders)
                {
                    if (ViewBag.Action == "edit")
                    {
                        <option selected="@(leader.Id == @ViewBag.Student.LeaderId)" data-toggle="tooltip"
                                data-placement="right" title="@leader.Surname">
                            @leader.Id
                        </option>
                    }
                    else
                    {
                        <option data-toggle="tooltip" data-placement="right" title="@leader.Surname">@leader.Id</option>
                    }
                }
            </select>
        </div>
        <div class="form-group">
            <label for="ContractId">Договор</label>
            <select class="form-control" name="ContractId" id="ContractId">
                @foreach (Contract contract in ViewBag.Contracts)
                {
                    if (ViewBag.Action == "edit")
                    {
                        <option selected="@(contract.Id == @ViewBag.Student.ContractId)" data-toggle="tooltip"
                                data-placement="right" title="@contract.Enter_Date">
                            @contract.Id
                        </option>
                    }
                    else
                    {
                        <option data-toggle="tooltip" data-placement="right" title="@contract.Enter_Date">@contract.Id</option>
                    }
                }
            </select>
        </div>
        <div class="form-group">
            <label for="FileNaming">Название файла</label>
            @if (ViewBag.Action == "edit")
            {
                <input name="FileNaming" type="text" class="form-control" id="FileNaming"
                       value="@ViewBag.Student.FileNaming">
            }
            else
            {
                <input name="FileNaming" type="text" class="form-control" id="FileNaming">
            }
        </div>
        <input hidden name="FileData" type="text" id="RealFileData"/>
        <div class="form-group">
            <label for="FileData">Файл</label>
            <input form="none" type="file" accept="application/vnd.openxmlformats-officedocument.wordprocessingml.document"
                       class="form-control-file" id="FileData">
        </div>
        <div class="form-group">
            <label for="Result">Результат</label>
            @if (ViewBag.Action == "edit")
            {
                <input name="Result" type="number" class="form-control" id="Result"
                       value="@ViewBag.Student.Result">
            }
            else
            {
                <input name="Result" type="number" class="form-control" id="Result">
            }
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
    </form>

<script>
    $('#FileData').on('change', ({ target }) => {
        const file = target.files[0];
        const fr = new FileReader();
        fr.readAsDataURL(file);
        console.log($('#RealFileData'))
        fr.onload = () => {
            $('#RealFileData').val(fr.result.toString());
        }
    })
</script>